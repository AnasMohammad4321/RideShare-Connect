// This is a simplified version of web3.min.js
// You may want to include the full web3.js library from https://web3js.readthedocs.io/

var Web3 = (function () {
    function Web3(provider) {
        this.currentProvider = provider;
    }

    Web3.prototype.eth = {
        getAccounts: async function () {
            return await window.ethereum.request({ method: 'eth_requestAccounts' });
        },
        Contract: function (abi, address) {
            return {
                methods: {
                    signUpAsDriver: function (availableSeats, seatPrice) {
                        return {
                            send: async function (options) {
                                const contract = new window.ethereum.Contract(abi, address);
                                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                                const method = contract.methods.signUpAsDriver(availableSeats, seatPrice);
                                return await method.send({ ...options, from: accounts[0] });
                            },
                        };
                    },
                    signUpAsPassenger: function (rideId) {
                        return {
                            send: async function (options) {
                                const contract = new window.ethereum.Contract(abi, address);
                                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                                const method = contract.methods.signUpAsPassenger(rideId);
                                return await method.send({ ...options, from: accounts[0] });
                            },
                        };
                    },
                    startRide: function (rideId) {
                        return {
                            send: async function (options) {
                                const contract = new window.ethereum.Contract(abi, address);
                                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                                const method = contract.methods.startRide(rideId);
                                return await method.send({ ...options, from: accounts[0] });
                            },
                        };
                    },
                    completeRide: function (rideId) {
                        return {
                            send: async function (options) {
                                const contract = new window.ethereum.Contract(abi, address);
                                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                                const method = contract.methods.completeRide(rideId);
                                return await method.send({ ...options, from: accounts[0] });
                            },
                        };
                    },
                },
            };
        },
    };

    return Web3;
})();
